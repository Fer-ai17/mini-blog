{% extends "base.html" %}
{% block title %}Tienda{% endblock %}

{% block content %}
<h1>Nuestros Productos</h1>

<div class="product-grid">
  {% for product in products %}
    <div class="product-card">
      {% if product.obj.label != "ninguno" %}
        <span class="badge {{ product.obj.label }}">
          {{ product.obj.get_label_display }}
        </span>
      {% endif %}

      <div class="product-image">
        {% if product.obj.image %}
          <img src="{{ product.obj.image.url }}" alt="{{ product.obj.name }}">
        {% else %}
          <div class="no-image">Sin imagen</div>
        {% endif %}
      </div>

      <div class="product-info">
        <h3><a href="{% url 'product_detail' product.obj.id %}">{{ product.obj.name }}</a></h3>
        <p class="price">
          {{ product.converted_price }}  <!-- Cambié item por product -->
          {% if product.currency != "COP" %}
            <small class="price-base">(~{{ product.base_price }})</small>
          {% endif %}
        </p>
        <p class="desc">{{ product.obj.description|truncatechars:50 }}</p>
        <p class="stock">Disponibles: {{ product.obj.stock }}</p>

        {% if product.obj.stock > 0 %}
          <a href="{% url 'add_to_cart' product.obj.id %}" class="btn">Añadir al carrito</a>
        {% else %}
          <p class="out-of-stock">Agotado</p>
        {% endif %}
      </div>
    </div>
  {% endfor %}
</div>
{% endblock %}